<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="%PUBLIC_URL%/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta
      name="description"
      content="Web site created using create-react-app"
    />
    <!-- Bootswatch CDN -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootswatch@4.5.2/dist/lux/bootstrap.min.css"
    />
    <!-- Custom CSS -->
    <link rel="stylesheet" href="%PUBLIC_URL%/css/style.css" />
    <title>SuperTeam Creator</title>
  </head>
  <body>
    <noscript>You need to enable JavaScript to run this app.</noscript>
    <div id="root"></div>

    <!-- 
      # Authentication Modal needed to be out here since 
      # I couldn't find a way to get React and JQuery 
      # (required for Bootstrap 4) to work together 
    -->

    <div
      class="modal fade"
      id="authModal"
      tabindex="-1"
      aria-labelledby="exampleModalLabel"
      aria-hidden="true"
      data-backdrop="static"
    >
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title text-center" id="exampleModalLabel">
              Please Authenticate Yourself
            </h5>
            </button>
          </div>
          <div class="modal-body">
            <form>
              <div class="form-group">
                <label for="userEmail">Email address</label>
                <input
                  type="email"
                  class="form-control"
                  id="userEmail"
                />
              </div>
              <div class="form-group">
                <label for="userPassword">Password</label>
                <input
                  type="password"
                  class="form-control"
                  id="userPassword"
                />
              </div>
          </div>
          <div class="modal-footer">
            <button 
              type="button" 
              class="btn btn-info" 
              onclick="authSubmitHandler()"
            >
              Submit
            </button>
          </form>
          </div>
        </div>
      </div>
    </div>
    <script
      src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
      integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx"
      crossorigin="anonymous"
    ></script>
    <script>
      const setLocal = (key, value) => {
        const serializedValue = JSON.stringify(value);
        localStorage.setItem(key, serializedValue);
      };

      const getLocal = (key) => {
        const value = localStorage.getItem(key);
        return JSON.parse(value);
      };

      
      window.addEventListener("DOMContentLoaded", () => {
        const token = getLocal("superheroToken");
        if (!token || (!token.email === "challenge.alkemy.org" && !token.password === "react")) {
          $("#authModal").modal("show");
        }
      });

      const authSubmitHandler = () => {
        const userEmail = document.getElementById("userEmail").value;
        const userPassword = document.getElementById("userPassword").value;
        console.log("User email: " + userEmail);
        console.log("User password: " + userPassword);

        if(userEmail === "challenge@alkemy.org" && userPassword === "react") {
          setLocal("superheroToken", {email: userEmail, password: userPassword});
          $("#authModal").modal("hide")
        }
      }
    </script>
  </body>
</html>
